<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>邀请好友</title>    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">    <meta content="telephone=no" name="format-detection">    <link rel="stylesheet" type="text/css" href="css/style.css">    <link rel="stylesheet" href="../lib/css/swiper-3.4.2.min.css"></head><body style="background:#fff1e0;"><div class="content">    <div class="banner">        <img src="images/reg_banner.png" width="100%">    </div>    <div class="regPanel">        <h2></h2>        <div class="regBox">            <input type="password" style="position:absolute;top:-50px;opacity:0;filter:alpha(opacity=0)"/>            <div class="item phone">                <label></label>                <input type="tel" name="phone" placeholder="请输入手机号" maxlength="11">            </div>            <div class="item pass">                <label></label>                <input type="password" name="pass" placeholder="请设置8-16位密码" maxlength="16">            </div>            <div class="item code">                <label></label>                <input type="code" name="code" placeholder="请输入验证码" maxlength="4">            </div>            <input type="button" value="获取验证码" class="getCode" onclick="getCode()">            <button onclick="reg()">立即注册</button>            <p>注册代表您已阅读并同意<a href="/web/mobile/index.html#/attentionProtocol">《加油多多用户使用协议》</a></p>        </div>    </div></div><script src="../lib/jquery-1.10.1.min.js"></script><script src="../lib/rem.js"></script><script src="../lib/layer_mobile/layer.js"></script><script>    var tjphone = getUrlParam('tj');    var tjcode = getUrlParam('tjcode');    var isSend = false;    var channel = getUrlParam('qd');    console.log(channel===undefined?'hykShare':channel)    if(tjphone!==undefined){        $('.regPanel h2').html('您的好友<label>'+tjphone.substr(0, 3) + '****' + tjphone.substr(7)+'</label>邀请您领取奖励');    }    function getCode() {        if (!checkPhone()) {            return false        }        var phone = $('input[name=phone]');        $.post("/web/f/app/getCode", {            phone: phone.val(),            type: 1        }, function (data) {            if (data.code !== '200') {                showMsg(data.msg)                return false            }            $('.getCode').attr('disabled', true).attr('style', 'background:#ccc;color:#999;')            $('.getCode').val('已发送');            isSend = true;            setTimeout(function () {                var count = 61                var resend = setInterval(function () {                    count--                    if (count > 0 && count < 61) {                        $('.getCode').val(count + 's重新获取');                    } else {                        clearInterval(resend)                        $('.getCode').attr('disabled', false).attr('style', '')                        $('.getCode').val('重新获取');                    }                }, 1000)            }, 500)        }, 'json')    }    function reg() {        if (!checkPhone() || !checkPass() || !checkPhonecode()) {            return false        }        var phone = $('input[name=phone]');        var pass = $('input[name=pass]');        $.post("/web/f/app/register", {            phone: phone.val(),            password: pass.val(),            inviterId: tjcode,            channel: channel===undefined?'hykShare':channel        }, function (data) {            if (data.code !== '200') {                showMsg(data.msg)                return false            }            showMsg('注册成功！')            setTimeout(function () {                window.location.href = '/web/mobile/activity/share/downApp.html'            }, 2000)        }, 'json')    }    function getUrlParam(name) {        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象        var r = window.location.search.substr(1).match(reg);  //匹配目标参数        if (r != null) {            return unescape(r[2]);        }    }    function checkPhone() {        var phone = $('input[name=phone]'),            reg = /^1[3|5|6|7|8|9][0-9]{9}$/;        if (phone.val() === "") {            showMsg('请输入手机号码')            return false;        } else if (!reg.test(phone.val())) {            showMsg('请输入正确手机号')            return false;        }else{            var isTrue = false            $.ajax({                type: "post",                url: "/web/f/app/checkPhone",                data: {                    phone: phone.val()                },                async: false,                dataType: 'json',                success: function (data) {                    if(data.code!=='200'){                        if(data.code==='402'){                            showMsg('手机号已注册！')                        }else{                            showMsg(data.msg)                        }                        return false                    }                    isTrue = true                }            })            return isTrue        }        return true    }    function checkPass() {        var pass = $('input[name=pass]');        if (pass.val() === '') {            showMsg('请输入密码')            return false;        } else if (pass.val().length < 8 || pass.val().length > 16) {            showMsg('密码长度为8-16位')            return false        }        return true    }    function checkPhonecode() {        var phone = $('input[name=phone]')        var phonecode = $('input[name=code]'),            reg = /^\d+$/;        if (!isSend) {            showMsg('请发送验证码')            return false;        }        if (phonecode.val() === '') {            showMsg('请输入短信验证码')            return false;        } else if (!reg.test(phonecode.val())) {            showMsg('短信验证码错误')            return false        } else if (phonecode.val().length < 4) {            showMsg('短信验证码错误')            return false        } else {            var isTrue = false            $.ajax({                type: "post",                url: "/web/f/app/checkCode",                data: {                    phone: phone.val(),                    userCode: phonecode.val(),                    type: 1                },                async: false,                dataType: 'json',                success: function (data) {                    if(data.code!=='200'){                        showMsg(data.msg)                        return false                    }                    isTrue = true                }            })            return isTrue        }        return true    }    function showMsg(tip) {        layer.open({            content: tip            , skin: 'msg'            , time: 2 //2秒后自动关闭        });    }</script></body></html>